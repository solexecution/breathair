<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>365 Days Wave</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      overflow: hidden;
    }

    body {
      display: flex;
      flex-direction: column;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    }

    header {
      padding: 16px;
      text-align: center;
      flex-shrink: 0;
    }

    .title {
      color: rgba(255, 255, 255, 0.8);
      font-family: 'Segoe UI', system-ui, sans-serif;
      font-size: 20px;
      font-weight: 300;
      letter-spacing: 4px;
    }

    .date-display {
      color: rgba(255, 255, 255, 0.5);
      font-family: 'Segoe UI', system-ui, sans-serif;
      font-size: 12px;
      letter-spacing: 1px;
      margin-top: 4px;
    }

    .container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      perspective: 800px;
      padding: 16px;
      overflow: hidden;
    }

    .grid {
      display: grid;
      transform-style: preserve-3d;
    }

    .dot {
      border-radius: 50%;
      transform-style: preserve-3d;
    }

    .dot.today {
      position: relative;
      z-index: 10;
      background: radial-gradient(circle at 30% 30%, rgba(255, 235, 150, 0.95), rgba(255, 200, 50, 0.8)) !important;
    }

    .dot.today::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 180%;
      height: 180%;
      border: 1.5px solid rgba(255, 215, 0, 0.6);
      border-radius: 50%;
      animation: pulse-ring 1.5s ease-out infinite;
    }

    @keyframes pulse-ring {
      0% {
        transform: translate(-50%, -50%) scale(0.6);
        opacity: 1;
      }
      100% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 0;
      }
    }

    footer {
      padding: 16px;
      text-align: center;
      flex-shrink: 0;
    }

    .info {
      color: rgba(255, 255, 255, 0.5);
      font-family: 'Segoe UI', system-ui, sans-serif;
      font-size: 11px;
    }
  </style>
</head>
<body>
  <header>
    <div class="title">365 DAYS</div>
    <div class="date-display" id="dateDisplay"></div>
  </header>
  <div class="container" id="container">
    <div class="grid" id="grid"></div>
  </div>
  <footer>
    <div class="info">Each dot is one day • <span style="color: #ffd700;">●</span> Today</div>
  </footer>

  <script>
    const container = document.getElementById('container');
    const grid = document.getElementById('grid');
    const dateDisplay = document.getElementById('dateDisplay');
    const totalDots = 365;
    let dots = [];
    let cols, rows, dotSize, gap;

    function getDayOfYear(date) {
      const start = new Date(date.getFullYear(), 0, 0);
      const diff = date - start;
      const oneDay = 1000 * 60 * 60 * 24;
      return Math.floor(diff / oneDay);
    }

    const today = new Date();
    const todayDayOfYear = getDayOfYear(today);

    const options = { weekday: 'short', month: 'short', day: 'numeric' };
    dateDisplay.textContent = `Day ${todayDayOfYear} • ${today.toLocaleDateString('en-US', options)}`;

    function calculateGrid() {
      const w = container.clientWidth - 32;
      const h = container.clientHeight - 32;

      let bestCols = 10;
      let bestSize = 0;

      for (let c = 8; c <= 40; c++) {
        const r = Math.ceil(totalDots / c);
        // More spacing - gap is 50% of dot size
        const gapRatio = 0.5;
        const cellSize = Math.min(w / c, h / r);
        const size = cellSize / (1 + gapRatio);

        if (size > bestSize && size > 4 && size < 30) {
          bestSize = size;
          bestCols = c;
        }
      }

      cols = bestCols;
      rows = Math.ceil(totalDots / cols);
      dotSize = Math.floor(bestSize);
      gap = Math.floor(dotSize * 0.5);

      return { cols, rows, dotSize, gap };
    }

    function buildGrid() {
      const { cols, dotSize, gap } = calculateGrid();

      grid.innerHTML = '';
      dots = [];

      grid.style.gridTemplateColumns = `repeat(${cols}, ${dotSize}px)`;
      grid.style.gap = `${gap}px`;

      for (let i = 0; i < totalDots; i++) {
        const dayNumber = i + 1;
        const dot = document.createElement('div');
        dot.className = 'dot';
        dot.style.width = `${dotSize}px`;
        dot.style.height = `${dotSize}px`;

        if (dayNumber === todayDayOfYear) {
          dot.classList.add('today');
        }

        grid.appendChild(dot);
        dots.push({
          element: dot,
          isToday: dayNumber === todayDayOfYear
        });
      }
    }

    let time = 0;
    const waveSpeed = 0.025;
    const waveAmplitude = 18;
    const waveFrequencyX = 0.15;
    const waveFrequencyY = 0.2;

    function animate() {
      time += waveSpeed;

      dots.forEach((dot, index) => {
        const row = Math.floor(index / cols);
        const col = index % cols;
        const { element, isToday } = dot;

        const wave1 = Math.sin(col * waveFrequencyX + time) * waveAmplitude;
        const wave2 = Math.sin(row * waveFrequencyY + time * 0.7) * (waveAmplitude * 0.5);
        const wave3 = Math.sin((col + row) * 0.1 + time * 1.3) * (waveAmplitude * 0.3);

        const z = wave1 + wave2 + wave3;
        const scale = 1 + (z / 150); // Reduced scale effect
        const brightness = 0.5 + (z + waveAmplitude * 2) / (waveAmplitude * 8);

        if (isToday) {
          element.style.transform = `translateZ(${z}px) scale(${scale})`;
          element.style.boxShadow = `0 0 ${dotSize * 0.4}px rgba(255, 215, 0, 0.4)`;
          element.style.opacity = 0.9;
        } else {
          const hue = 170 + (col / cols) * 30 + Math.sin(time + row * 0.1) * 15;
          const saturation = 50 + z * 0.3;
          const lightness = 60 + z * 0.4;

          element.style.transform = `translateZ(${z}px) scale(${scale})`;
          element.style.background = `radial-gradient(circle at 30% 30%, 
            hsla(${hue}, ${saturation}%, ${lightness + 15}%, ${0.6 + brightness * 0.3}), 
            hsla(${hue}, ${saturation + 10}%, ${lightness - 5}%, ${0.4 + brightness * 0.3}))`;
          element.style.boxShadow = `0 0 ${dotSize * 0.3}px hsla(${hue}, 70%, 60%, ${brightness * 0.3})`;
          element.style.opacity = 0.5 + brightness * 0.4;
        }
      });

      requestAnimationFrame(animate);
    }

    buildGrid();
    animate();

    let resizeTimeout;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(buildGrid, 150);
    });
  </script>
</body>
</html>
